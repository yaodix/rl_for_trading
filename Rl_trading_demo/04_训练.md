

### Training Process Step-by-Step

1. **Data Preparation** :

* Collect financial data
* Define and normalize features
* Split into training and test sets
* Optional validation set for overfitting assessment

1. **Environment Setup** :

* Define state and action spaces

1. **Coding the Agent** :

* Start training in episodes: Each episode runs through the full dataset

1. **Iterative Actions** :

* Get initial state at t=0, perform action, receive next state t=1
* Calculate reward, save experience, and update to t=t+1

1. **Experience Replay** :

* Runs after the initial n steps
* Samples a mini-batch for model fitting
* Decays epsilon in the act function
* Continues iterating

训练参数

![1770964754250](image/04_训练/1770964754250.png)

exp replay batch size: 从32,或64开始确保稳定训练

![1770964987370](image/04_训练/1770964987370.png)

![1770965318499](image/04_训练/1770965318499.png)
